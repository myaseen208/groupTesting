<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>EM Algorithm to Estimate the Prevalence of a Disease from Group Testing Data — prop.gt • groupTesting</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="EM Algorithm to Estimate the Prevalence of a Disease from Group Testing Data — prop.gt"><meta property="og:description" content="This function implements an expectation-maximization (EM) algorithm to find the maximum likelihood estimate (MLE) of a disease prevalence, p, based on group testing data. The EM algorithm, which is outlined in Warasi (2021), can model pooling data observed from any group testing protocol used in practice, including hierarchical and array testing (Kim et al., 2007)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">groupTesting</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>EM Algorithm to Estimate the Prevalence of a Disease from Group Testing Data</h1>
    
    <div class="hidden name"><code>prop.gt.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function implements an expectation-maximization (EM) algorithm to find the maximum likelihood estimate (MLE) of a disease prevalence, p, based on group testing data. The EM algorithm, which is outlined in Warasi (2021), can model pooling data observed from <strong>any</strong> group testing protocol used in practice, including hierarchical and array testing (Kim et al., 2007).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prop.gt</span><span class="op">(</span></span>
<span>  <span class="va">p0</span>,</span>
<span>  <span class="va">gtData</span>,</span>
<span>  covariance <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nburn <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  ngit <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  maxit <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  tracing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>p0</dt>
<dd><p>An initial value of the prevalence.</p></dd>


<dt>gtData</dt>
<dd><p>A matrix or data.frame consisting of the pooled test outcomes and other information from a group testing application. Needs to be specified as shown in the example below.</p></dd>


<dt>covariance</dt>
<dd><p>When TRUE, the variance is calculated at the MLE.</p></dd>


<dt>nburn</dt>
<dd><p>The number of initial Gibbs iterates to be discarded.</p></dd>


<dt>ngit</dt>
<dd><p>The number of Gibbs iterates to be used in the E-step after discarding the initial iterates as a burn-in period.</p></dd>


<dt>maxit</dt>
<dd><p>The maximum number of EM steps (iterations) allowed in the EM algorithm.</p></dd>


<dt>tol</dt>
<dd><p>Convergence tolerance used in the EM algorithm.</p></dd>


<dt>tracing</dt>
<dd><p>When TRUE, progress in the EM algorithm is displayed.</p></dd>


<dt>conf.level</dt>
<dd><p>Confidence level to be used for the Wald confidence interval.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with components:</p>
<dl><dt>param</dt>
<dd><p>The MLE of the disease prevalence.</p></dd>

<dt>covariance</dt>
<dd><p>Estimated variance for the disease prevalence.</p></dd>

<dt>iterUsed</dt>
<dd><p>The number of EM iterations used for convergence.</p></dd>

<dt>convergence</dt>
<dd><p>0 if the EM algorithm converges successfully and 1 if the iteration limit <code>maxit</code> has been reached.</p></dd>

<dt>summary</dt>
<dd><p>Estimation summary with Wald confidence interval.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>gtData</code> must be specified as follows. Columns 1-5 consist of the pooled test outcomes (0 for negative and 1 for positive), pool sizes, pool-specific sensitivities, pool-specific specificities, and assay ID numbers, respectively. From column 6 onward, the pool member ID numbers need to be specified. Note that the ID numbers must start with 1 and increase consecutively up to <code>N</code>, the total number of individuals tested. <strong>For smaller pools, incomplete ID numbers must be filled out by -9 or any non-positive numbers</strong> as shown in the example below.</p>
<p>|     |  Z  |  psz  |   Se   |   Sp   |  Assay  |  Mem1  |  Mem2  |  Mem3  |  Mem4  |  Mem5  |  Mem6  |
|:---:|:---:|:-----:|:------:|:------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|:-------:|       
| Pool:1   |  1  |   6   |  0.90  |  0.92  |    1    |    1    |    2    |    3    |    4    |    5    |    6    |
| Pool:2   |  0  |   6   |  0.90  |  0.92  |    1    |    7    |    8    |    9    |   10    |    11   |   12    |
| Pool:3   |  1  |   2   |  0.95  |  0.96  |    2    |    1    |    2    |   -9    |   -9    |    -9   |   -9    |
| Pool:4   |  0  |   2   |  0.95  |  0.96  |    2    |    3    |    4    |   -9    |   -9    |    -9   |   -9    |
| Pool:5   |  1  |   2   |  0.95  |  0.96  |    2    |    5    |    6    |   -9    |   -9    |    -9   |   -9    |
| Pool:6   |  0  |   1   |  0.92  |  0.90  |    3    |    1    |   -9    |   -9    |   -9    |    -9   |   -9    |
| Pool:7   |  1  |   1   |  0.92  |  0.90  |    3    |    2    |   -9    |   -9    |   -9    |    -9   |   -9    |
| Pool:8   |  0  |   1   |  0.92  |  0.90  |    3    |    5    |   -9    |   -9    |   -9    |    -9   |   -9    |
| Pool:9   |  0  |   1   |  0.92  |  0.90  |    3    |    6    |   -9    |   -9    |   -9    |    -9   |   -9    |</p>
<p>This is an example of <code>gtData</code>, where 12 individuals are assigned to 2 non-overlapping initial pools and then tested based on the 3-stage hierarchical protocol. The test outcomes, <code>Z</code>, from 9 pools are in column 1. In three stages, different pool sizes (6, 2, and 1), sensitivities, specificities, and assays are used. The ID numbers of the pool members are shown in columns 6-11. The row names and column names are not required. Note that the EM algorithm can accommodate any group testing data including those described in Kim et al. (2007). For individual testing data, the pool size in column 2 is 1 for all pools.</p>
<p>The EM algorithm implements a Gibbs sampler to approximate quantities required to complete the E-step. Under each EM iteration, <code>ngit</code> Gibbs samples are retained for these purposes after discarding the initial <code>nburn</code> samples.</p>
<p>The variance of the MLE is calculated by an appeal to the missing data principle and the method outlined in Louis (1982).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kim HY, Hudgens M, Dreyfuss J, Westreich D, and Pilcher C. (2007). Comparison of Group Testing Algorithms for Case Identification in the Presence of Testing Error. <em>Biometrics</em>, 63:1152-1163.</p>
<p>Litvak E, Tu X, and Pagano M. (1994). Screening for the Presence of a Disease by Pooling Sera Samples. <em>Journal of the American Statistical Association</em>, 89:424-434.</p>
<p>Liu A, Liu C, Zhang Z, and Albert P. (2012). Optimality of Group Testing in the Presence of Misclassification. <em>Biometrika</em>, 99:245-251.</p>
<p>Louis T. (1982). Finding the Observed Information Matrix when Using the EM algorithm. <em>Journal of the Royal Statistical Society: Series B</em>, 44:226-233.</p>
<p>Warasi M. (2021). groupTesting: An R Package for Group Testing Estimation. <em>Communications in Statistics-Simulation and Computation</em>. Published online on Dec 9, 2021.
Available at https://www.tandfonline.com/doi/full/10.1080/03610918.2021.2009867</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hier.gt.simulation.html">hier.gt.simulation</a></code> and <code><a href="array.gt.simulation.html">array.gt.simulation</a></code> for group testing data simulation, and <code><a href="glm.gt.html">glm.gt</a></code> for group testing regression models.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">groupTesting</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## To illustrate 'prop.gt', we use data simulated by </span></span></span>
<span class="r-in"><span><span class="co">## the R functions 'hier.gt.simulation' and 'array.gt.simulation'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The simulated data-structures are consistent  </span></span></span>
<span class="r-in"><span><span class="co">## with the data-structure required for 'gtData'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1: MLE from 3-stage hierarchical group testing data.</span></span></span>
<span class="r-in"><span><span class="co">## The data used is simulated by 'hier.gt.simulation'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">90</span>               <span class="co"># Sample size</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">3</span>                <span class="co"># 3-stage hierarchical testing</span></span></span>
<span class="r-in"><span><span class="va">psz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>       <span class="co"># Pool sizes used in stages 1-3</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.95</span>,<span class="fl">.95</span>,<span class="fl">.98</span><span class="op">)</span>  <span class="co"># Sensitivities in stages 1-3</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.95</span>,<span class="fl">.98</span>,<span class="fl">.96</span><span class="op">)</span>  <span class="co"># Specificities in stages 1-3</span></span></span>
<span class="r-in"><span><span class="va">assayID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>   <span class="co"># Assays used in stages 1-3</span></span></span>
<span class="r-in"><span><span class="va">p.t</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>           <span class="co"># The TRUE parameter to be estimated</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulating data:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="hier.gt.simulation.html">hier.gt.simulation</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">p.t</span>,<span class="va">S</span>,<span class="va">psz</span>,<span class="va">Se</span>,<span class="va">Sp</span>,<span class="va">assayID</span><span class="op">)</span><span class="op">$</span><span class="va">gtData</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Running the EM algorithm:</span></span></span>
<span class="r-in"><span><span class="va">pStart</span> <span class="op">&lt;-</span> <span class="va">p.t</span> <span class="op">+</span> <span class="fl">0.2</span>   <span class="co"># Initial value</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prop.gt</span><span class="op">(</span>p0<span class="op">=</span><span class="va">pStart</span>,gtData<span class="op">=</span><span class="va">gtOut</span>,covariance<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>               nburn<span class="op">=</span><span class="fl">2000</span>,ngit<span class="op">=</span><span class="fl">5000</span>,maxit<span class="op">=</span><span class="fl">200</span>,tol<span class="op">=</span><span class="fl">1e-03</span>,</span></span>
<span class="r-in"><span>               tracing<span class="op">=</span><span class="cn">TRUE</span>,conf.level<span class="op">=</span><span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1013822 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.05878667 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.05219333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.05158 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimation results:</span></span></span>
<span class="r-in"><span><span class="co"># &gt; res</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># $param</span></span></span>
<span class="r-in"><span><span class="co"># [1] 0.05158</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># $covariance</span></span></span>
<span class="r-in"><span><span class="co">#              [,1]</span></span></span>
<span class="r-in"><span><span class="co"># [1,] 0.0006374296</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># $iterUsed</span></span></span>
<span class="r-in"><span><span class="co"># [1] 4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># $convergence</span></span></span>
<span class="r-in"><span><span class="co"># [1] 0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># $summary</span></span></span>
<span class="r-in"><span><span class="co">#      Estimate StdErr 95%lower 95%upper</span></span></span>
<span class="r-in"><span><span class="co"># prop    0.052  0.025    0.002    0.101</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2: MLE from two-dimensional array testing data.</span></span></span>
<span class="r-in"><span><span class="co">## The data used is simulated by 'array.gt.simulation'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span>             <span class="co"># Sample size</span></span></span>
<span class="r-in"><span><span class="va">protocol</span> <span class="op">&lt;-</span> <span class="st">"A2"</span>     <span class="co"># 2-stage array without testing the initial master pool</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>               <span class="co"># Row/column size</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span>  <span class="co"># Sensitivities</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.98</span>, <span class="fl">0.98</span><span class="op">)</span>  <span class="co"># Specificities</span></span></span>
<span class="r-in"><span><span class="va">assayID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>   <span class="co"># The same assay in both stages</span></span></span>
<span class="r-in"><span><span class="va">p.true</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>       <span class="co"># The TRUE parameter to be estimated</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulating data:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="array.gt.simulation.html">array.gt.simulation</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">p.true</span>,<span class="va">protocol</span>,<span class="va">n</span>,<span class="va">Se</span>,<span class="va">Sp</span>,<span class="va">assayID</span><span class="op">)</span><span class="op">$</span><span class="va">gtData</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting the model:</span></span></span>
<span class="r-in"><span><span class="va">pStart</span> <span class="op">&lt;-</span> <span class="va">p.true</span> <span class="op">+</span> <span class="fl">0.2</span>  <span class="co"># Initial value</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prop.gt</span><span class="op">(</span>p0<span class="op">=</span><span class="va">pStart</span>,gtData<span class="op">=</span><span class="va">gtOut</span>,covariance<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.070322 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.051938 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.04968 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.04951 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04951</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $covariance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.0005521378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iterUsed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate StdErr 95%lower 95%upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prop     0.05  0.023    0.003    0.096</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## Example 3: MLE from non-overlapping initial pooled responses.</span></span></span>
<span class="r-in"><span><span class="co">## The data used is simulated by 'hier.gt.simulation'. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Note: With initial pooled responses, our MLE is equivalent  </span></span></span>
<span class="r-in"><span><span class="co">## to the MLE in Litvak et al. (1994) and Liu et al. (2012).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span>             <span class="co"># Sample size</span></span></span>
<span class="r-in"><span><span class="va">psz</span> <span class="op">&lt;-</span> <span class="fl">5</span>              <span class="co"># Pool size</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span>                <span class="co"># 1-stage testing</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fl">0.95</span>            <span class="co"># Sensitivity</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fl">0.99</span>            <span class="co"># Specificity</span></span></span>
<span class="r-in"><span><span class="va">assayID</span> <span class="op">&lt;-</span> <span class="fl">1</span>          <span class="co"># Assay used for all pools</span></span></span>
<span class="r-in"><span><span class="va">p.true</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># True parameter</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="hier.gt.simulation.html">hier.gt.simulation</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">p.true</span>,<span class="va">S</span>,<span class="va">psz</span>,<span class="va">Se</span>,<span class="va">Sp</span>,<span class="va">assayID</span><span class="op">)</span><span class="op">$</span><span class="va">gtData</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pStart</span> <span class="op">&lt;-</span> <span class="va">p.true</span> <span class="op">+</span> <span class="fl">0.2</span>   <span class="co"># Initial value</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prop.gt</span><span class="op">(</span>p0<span class="op">=</span><span class="va">pStart</span>,gtData<span class="op">=</span><span class="va">gtOut</span>,</span></span>
<span class="r-in"><span>               covariance<span class="op">=</span><span class="cn">TRUE</span>,nburn<span class="op">=</span><span class="fl">2000</span>,ngit<span class="op">=</span><span class="fl">5000</span>,</span></span>
<span class="r-in"><span>               maxit<span class="op">=</span><span class="fl">200</span>,tol<span class="op">=</span><span class="fl">1e-03</span>,tracing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1147154 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.0685936 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0585228 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.0564332 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.0560026 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0560026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $covariance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 6.711238e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iterUsed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate StdErr 95%lower 95%upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prop    0.056  0.008     0.04    0.072</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4: MLE from individual (one-by-one) testing data.</span></span></span>
<span class="r-in"><span><span class="co">## The data used is simulated by 'hier.gt.simulation'.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">1000</span>             <span class="co"># Sample size</span></span></span>
<span class="r-in"><span><span class="va">psz</span> <span class="op">&lt;-</span> <span class="fl">1</span>              <span class="co"># Pool size 1 (i.e., individual testing)</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span>                <span class="co"># 1-stage testing</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fl">0.95</span>            <span class="co"># Sensitivity</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fl">0.99</span>            <span class="co"># Specificity</span></span></span>
<span class="r-in"><span><span class="va">assayID</span> <span class="op">&lt;-</span> <span class="fl">1</span>          <span class="co"># Assay used for all pools</span></span></span>
<span class="r-in"><span><span class="va">p.true</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>        <span class="co"># True parameter</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gtOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="hier.gt.simulation.html">hier.gt.simulation</a></span><span class="op">(</span><span class="va">N</span>,<span class="va">p.true</span>,<span class="va">S</span>,<span class="va">psz</span>,<span class="va">Se</span>,<span class="va">Sp</span>,<span class="va">assayID</span><span class="op">)</span><span class="op">$</span><span class="va">gtData</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pStart</span> <span class="op">&lt;-</span> <span class="va">p.true</span> <span class="op">+</span> <span class="fl">0.2</span>   <span class="co"># Initial value</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prop.gt</span><span class="op">(</span>p0<span class="op">=</span><span class="va">pStart</span>,gtData<span class="op">=</span><span class="va">gtOut</span>,</span></span>
<span class="r-in"><span>               covariance<span class="op">=</span><span class="cn">TRUE</span>,nburn<span class="op">=</span><span class="fl">2000</span>,</span></span>
<span class="r-in"><span>               ngit<span class="op">=</span><span class="fl">5000</span>,maxit<span class="op">=</span><span class="fl">200</span>,</span></span>
<span class="r-in"><span>               tol<span class="op">=</span><span class="fl">1e-03</span>,tracing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.0775272 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.060846 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0580752 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.057512 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.057512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $covariance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 6.789276e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iterUsed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate StdErr 95%lower 95%upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prop    0.058  0.008    0.041    0.074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 5: Using pooled testing data.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pooled test outcomes:</span></span></span>
<span class="r-in"><span><span class="va">Z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>     </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pool sizes used:</span></span></span>
<span class="r-in"><span><span class="va">psz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pool-specific Se &amp; Sp:</span></span></span>
<span class="r-in"><span><span class="va">Se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.90</span>, <span class="fl">.90</span>, <span class="fl">.95</span>, <span class="fl">.95</span>, <span class="fl">.95</span>, <span class="fl">.92</span>, <span class="fl">.92</span>, <span class="fl">.92</span>, <span class="fl">.92</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.92</span>, <span class="fl">.92</span>, <span class="fl">.96</span>, <span class="fl">.96</span>, <span class="fl">.96</span>, <span class="fl">.90</span>, <span class="fl">.90</span>, <span class="fl">.90</span>, <span class="fl">.90</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Assays used:</span></span></span>
<span class="r-in"><span><span class="va">Assay</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Pool members:</span></span></span>
<span class="r-in"><span><span class="va">Memb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span> </span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>,  <span class="fl">3</span>,  <span class="fl">4</span>,  <span class="fl">5</span>,  <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">8</span>,  <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span>, <span class="op">-</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The data-structure suited for 'gtData':</span></span></span>
<span class="r-in"><span><span class="va">gtOut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Z</span>, <span class="va">psz</span>, <span class="va">Se</span>, <span class="va">Sp</span>, <span class="va">Assay</span>, <span class="va">Memb</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting the model:</span></span></span>
<span class="r-in"><span><span class="va">pStart</span> <span class="op">&lt;-</span> <span class="fl">0.10</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">prop.gt</span><span class="op">(</span>p0<span class="op">=</span><span class="va">pStart</span>,gtData<span class="op">=</span><span class="va">gtOut</span>,</span></span>
<span class="r-in"><span>               covariance<span class="op">=</span><span class="cn">TRUE</span>,nburn<span class="op">=</span><span class="fl">2000</span>,</span></span>
<span class="r-in"><span>               ngit<span class="op">=</span><span class="fl">5000</span>,maxit<span class="op">=</span><span class="fl">200</span>,</span></span>
<span class="r-in"><span>               tol<span class="op">=</span><span class="fl">1e-03</span>,tracing<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1206167 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.1283667 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.1326 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.13295 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $param</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.13295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $covariance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.01595711</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $iterUsed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $convergence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Estimate StdErr 95%lower 95%upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> prop    0.133  0.126   -0.115    0.381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Md S. Warasi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

